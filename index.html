<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>README Presenter</title>
  <!-- Fonts & base styles -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root{--bg:#0b1020;--panel:#0e1428;--muted:#99a1b3;--text:#e6eaf2;--accent:#6ea8fe;--border:#1c2238}
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;background:#0b1020;color:var(--text);}
    a{color:var(--accent)}
    .app{display:grid;grid-template-rows:auto 1fr;min-height:100vh}
    header{position:sticky;top:0;z-index:10;background:rgba(11,16,32,.75);backdrop-filter:saturate(1.1) blur(8px);border-bottom:1px solid var(--border)}
    .bar{display:flex;gap:8px;align-items:center;max-width:1200px;margin:0 auto;padding:10px 16px}
    .title{font-weight:600}
    .hint{color:var(--muted);font-size:12px}
    .btn{background:#141b33;border:1px solid var(--border);color:var(--text);padding:8px 10px;border-radius:10px;font-size:13px;cursor:pointer}
    .btn:hover{background:#182040}
    .btn.primary{background:#2b3a6b}
    .layout{display:grid;grid-template-columns:300px 1fr;gap:14px;max-width:1200px;margin:16px auto;padding:0 16px}
    .card{background:var(--panel);border:1px solid var(--border);border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,.25)}
    .sidebar{padding:10px}
    .search{width:100%;padding:10px 12px;border:1px solid var(--border);border-radius:12px;background:#0b1020;color:var(--text)}
    .list{margin-top:10px;max-height:70vh;overflow:auto}
    .item{display:flex;gap:10px;align-items:flex-start;padding:10px;border-radius:12px;cursor:pointer}
    .item:hover{background:#111735}
    .item .name{font-weight:500}
    .item .meta{font-size:12px;color:var(--muted)}
    .content{display:grid;grid-template-rows:auto 1fr}
    .controls{display:flex;flex-wrap:wrap;gap:8px;align-items:center;justify-content:space-between;padding:12px 14px;border-bottom:1px solid var(--border)}
    .crumbs{font-size:12px;color:var(--muted)}
    .viewer{display:grid;grid-template-columns:1fr;min-height:60vh}
    .pane{padding:16px;overflow:auto}
    .pane + .pane{border-top:1px solid var(--border)}
    .split{grid-template-columns:1fr 1fr}

    /* GitHub Markdown styling (lightly adapted) */
    .markdown-body{font-size:16px;line-height:1.65;color:#e6eaf2}
    .markdown-body h1,.markdown-body h2,.markdown-body h3{border-bottom:1px solid #1f2743;padding-bottom:.3em}
    .markdown-body pre{background:#0b1020;border:1px solid var(--border);border-radius:12px;padding:14px;overflow:auto}
    .markdown-body code{font-family:ui-monospace,Menlo,Consolas,monospace}
    .muted{color:var(--muted)}
    .hidden{display:none}
    iframe{width:100%;height:70vh;border:0;border-top:1px solid var(--border)}
    .pill{display:inline-flex;gap:6px;align-items:center;border:1px solid var(--border);padding:4px 8px;border-radius:999px;font-size:12px;background:#101633}
  </style>
  <!-- Markdown renderer, sanitizer, syntax highlight, and CodeMirror editor -->
  <script src="https://cdn.jsdelivr.net/npm/markdown-it@14/dist/markdown-it.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/dompurify@3.1.7/dist/purify.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/lib/common.min.js"></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github-dark-dimmed.min.css"/>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/codemirror@5.65.17/lib/codemirror.min.css">
  <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.17/lib/codemirror.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.17/mode/markdown/markdown.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.17/addon/edit/closebrackets.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.17/addon/display/placeholder.js"></script>
</head>
<body>
<div class="app">
  <header>
    <div class="bar">
      <div class="title">README Presenter</div>
      <div class="hint">Nice, readable rendering of your repo's README & docs. No commits needed for preview.</div>
      <div style="margin-left:auto;display:flex;gap:8px">
        <button class="btn" id="editToggle">Toggle Edit Preview</button>
        <button class="btn" id="downloadBtn">Download Edited File</button>
        <a class="btn primary" id="openOnGitHub" target="_blank">Open on GitHub</a>
      </div>
    </div>
  </header>

  <div class="layout">
    <!-- Sidebar: repo browser -->
    <aside class="card sidebar">
      <input id="search" class="search" placeholder="Filter filesâ€¦ (md, ipynb, txt)" />
      <div class="list" id="fileList"></div>
    </aside>

    <!-- Content: README / file viewer -->
    <section class="card content">
      <div class="controls">
        <div>
          <div id="repoTitle" class="pill">owner/repo@branch</div>
          <div class="crumbs" id="crumbs">README.md</div>
        </div>
        <div style="display:flex;gap:8px;align-items:center">
          <span class="muted">.md renders here â€¢ .ipynb opens nbviewer</span>
        </div>
      </div>

      <div id="viewer" class="viewer">
        <div id="markdownPane" class="pane">
          <article id="md" class="markdown-body">Loadingâ€¦</article>
        </div>
        <div id="editorPane" class="pane hidden">
          <textarea id="editor" placeholder="Edit Markdown here â€” your changes stay in the browser until you download."></textarea>
        </div>
        <div id="nbPane" class="pane hidden">
          <div class="muted">Notebook preview via nbviewer (fully client-side). If you want runnable Python in the browser, add JupyterLite â€” see notes below.</div>
          <iframe id="nbFrame" title="Notebook"></iframe>
        </div>
      </div>
    </section>
  </div>
</div>

<script>
  // === CONFIG: set your repo ===
  const OWNER = 'barbavegeta';   // <-- change me
  const REPO  = 'Google_Advanced_Data_Analytics-Tik_Tok_Project';       // <-- change me
  const BRANCH = 'main';           // e.g., 'main' or 'master'
  const DEFAULT_PATH = 'README.md';

  const OWNER = 'barbavegeta';   // <-- change me
  const REPO  = 'Genomic_Data_Science_Specialization';       // <-- change me
  const BRANCH = 'main';           // e.g., 'main' or 'master'
  const DEFAULT_PATH = 'README.md';

  // === STATE ===
  let currentPath = DEFAULT_PATH;
  let originalMarkdown = '';
  let cm = null;

  const md = window.markdownit({
    html: true,
    linkify: true,
    typographer: true,
    highlight: function (str, lang) {
      try { return hljs.highlightAuto(str, lang ? [lang] : undefined).value; }
      catch (__) { return ''; }
    }
  });

  function ghContentsURL(path) {
    return `https://api.github.com/repos/${OWNER}/${REPO}/contents/${encodeURIComponent(path)}`;
  }
  function ghRawURL(path) {
    return `https://raw.githubusercontent.com/${OWNER}/${REPO}/${BRANCH}/${path}`;
  }
  function nbviewerURL(path) {
    return `https://nbviewer.org/github/${OWNER}/${REPO}/blob/${BRANCH}/${path}`;
  }

  function setHeader() {
    document.getElementById('repoTitle').textContent = `${OWNER}/${REPO}@${BRANCH}`;
    document.getElementById('crumbs').textContent = currentPath;
    document.getElementById('openOnGitHub').href = `https://github.com/${OWNER}/${REPO}/blob/${BRANCH}/${currentPath}`;
  }

  async function listFiles() {
    // grab top-level and docs folder; you can expand this if needed
    const roots = ['', 'docs'];
    const acc = [];
    for (const root of roots) {
      try {
        const res = await fetch(ghContentsURL(root));
        if (!res.ok) continue;
        const items = await res.json();
        for (const it of items) {
          if (it.type === 'file' && /\.(md|markdown|ipynb|txt)$/i.test(it.name)) {
            acc.push({ path: it.path, name: it.name });
          }
        }
      } catch {}
    }
    // ensure README first
    acc.sort((a,b) => a.name.toLowerCase() === 'readme.md' ? -1 : a.name.localeCompare(b.name));
    const list = document.getElementById('fileList');
    list.innerHTML = '';
    for (const f of acc) {
      const div = document.createElement('div');
      div.className = 'item';
      const ext = f.name.split('.').pop().toLowerCase();
      const icon = ext === 'ipynb' ? 'ðŸ““' : (ext === 'md' || ext === 'markdown' ? 'ðŸ“„' : 'ðŸ“˜');
      div.innerHTML = `<div style="font-size:18px">${icon}</div><div><div class="name">${f.name}</div><div class="meta">${f.path}</div></div>`;
      div.onclick = () => openPath(f.path);
      list.appendChild(div);
    }

    // quick filter
    const q = document.getElementById('search');
    q.oninput = () => {
      const term = q.value.toLowerCase();
      [...list.children].forEach(li => { li.style.display = li.textContent.toLowerCase().includes(term) ? '' : 'none'; });
    };
  }

  async function loadMarkdown(path) {
    const res = await fetch(ghRawURL(path));
    if (!res.ok) throw new Error('Unable to fetch file');
    const text = await res.text();
    originalMarkdown = text;
    renderMarkdown(text);
    ensureEditor(text);
  }

  function renderMarkdown(mdText) {
    const safe = DOMPurify.sanitize(md.render(mdText));
    document.getElementById('md').innerHTML = safe;
    // re-run highlight.js in case we injected new code blocks
    document.querySelectorAll('pre code').forEach(block => hljs.highlightElement(block));
  }

  function ensureEditor(text) {
    const ta = document.getElementById('editor');
    if (!cm) {
      cm = CodeMirror.fromTextArea(ta, { mode: 'markdown', lineNumbers: true, lineWrapping: true, autoCloseBrackets: true, theme: 'default' });
      cm.on('change', () => renderMarkdown(cm.getValue()));
    }
    cm.setValue(text);
  }

  function toggleEdit() {
    const viewer = document.getElementById('viewer');
    const editorPane = document.getElementById('editorPane');
    const markdownPane = document.getElementById('markdownPane');
    const nbPane = document.getElementById('nbPane');
    if (currentPath.endsWith('.ipynb')) return; // editing is only for md/txt
    const split = viewer.classList.toggle('split');
    editorPane.classList.toggle('hidden');
    markdownPane.classList.remove('hidden');
    nbPane.classList.add('hidden');
  }

  async function openPath(path) {
    currentPath = path;
    setHeader();
    const isMD = /\.(md|markdown|txt)$/i.test(path);
    const isNB = /\.ipynb$/i.test(path);
    const nbPane = document.getElementById('nbPane');
    const mdPane = document.getElementById('markdownPane');
    const editorPane = document.getElementById('editorPane');
    document.getElementById('viewer').classList.remove('split');

    if (isNB) {
      // show nbviewer iframe
      nbPane.classList.remove('hidden');
      mdPane.classList.add('hidden');
      editorPane.classList.add('hidden');
      document.getElementById('nbFrame').src = nbviewerURL(path);
    } else if (isMD) {
      nbPane.classList.add('hidden');
      mdPane.classList.remove('hidden');
      editorPane.classList.add('hidden');
      try { await loadMarkdown(path); } catch { document.getElementById('md').textContent = 'Failed to load file.'; }
    } else {
      nbPane.classList.add('hidden');
      mdPane.classList.remove('hidden');
      editorPane.classList.add('hidden');
      try {
        const res = await fetch(ghRawURL(path));
        const text = await res.text();
        renderMarkdown('```\n' + text.replace(/[`$]/g, m => m === '`' ? '\\`' : m) + '\n```');
      } catch { document.getElementById('md').textContent = 'Preview not available.'; }
    }
  }

  // === Buttons ===
  document.getElementById('editToggle').onclick = toggleEdit;
  document.getElementById('downloadBtn').onclick = () => {
    const toSave = cm ? cm.getValue() : originalMarkdown;
    const blob = new Blob([toSave], {type: 'text/markdown'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url; a.download = currentPath.split('/').pop();
    document.body.appendChild(a); a.click(); a.remove();
    URL.revokeObjectURL(url);
  };

  // === Init ===
  (async function init(){
    setHeader();
    await listFiles();
    await openPath(DEFAULT_PATH);
  })();
</script>

<!--
NOTES / HOW TO GET PYTHON & JUPYTER WORKING RIGHT ON GITHUB PAGES (no server):
1) Jupyter notebooks (.ipynb) are opened via nbviewer in an iframe â€” good for viewing.
2) If you want runnable Python in the browser, add JupyterLite (Pyodide-based):
   - Follow https://jupyterlite.readthedocs.io/en/latest/ to create a `jupyterlite` folder in your repo and publish.
   - Then add a button that links to `/jupyterlite/retro/notebooks/your_notebook.ipynb`.
   - This runs **fully in the browser** (no server, no token), perfect for GitHub Pages.
3) If you prefer a real Python/OS environment, wire up Thebe + Binder:
   - https://thebe.readthedocs.io/ â€” turns code blocks in Markdown into live cells backed by Binder.
   - Binder spins up a remote kernel; slower to start but full Python.
4) Editing without committing: this page already lets you edit Markdown locally and download changes.
   - To save to GitHub, you must commit at some point (thatâ€™s how Git works). For painless previews,
     use a separate branch + GitHub Pages â€œpreview deploymentsâ€ (or Netlify/Cloudflare Pages) so you donâ€™t touch main until ready.
-->
</body>
</html>
